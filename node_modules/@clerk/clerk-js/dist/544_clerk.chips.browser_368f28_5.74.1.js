"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["544"],{1816:function(e,t,i){i.d(t,{$:()=>y});var a=i(9109),n=i(3799),r=i(9144),o=i(6988),l=i(2672),s=i(431),c=i(9460),d=i(8487),u=i(2654),g=i(3412),h=i(7263),p=i(7259),z=i(8870),m=i(6788),b=i(8969),x=i(9888),S=i(4174),$=i(7703),Z=i(8493),C=i(5727),v=i(8181),f=i(7484);let y=(0,l.withCardStateProvider)(e=>{let t=(0,l.useCardState)(),i=(0,b.a2)({onNextStep:()=>t.setError(void 0)}),y=(0,r.useContext)(o.H),w=r.useRef(null),{createOrganization:L,isLoaded:P,setActive:T,userMemberships:k}=(0,n.eW)({userMemberships:f.AO.userMemberships}),{organization:A}=(0,n.o8)(),[B,I]=r.useState(),D=(0,m.Yp)("name","",{type:"text",label:(0,$.u1)("formFieldLabel__organizationName"),placeholder:(0,$.u1)("formFieldInputPlaceholder__organizationName")}),O=(0,m.Yp)("slug","",{type:"text",label:(0,$.u1)("formFieldLabel__organizationSlug"),placeholder:(0,$.u1)("formFieldInputPlaceholder__organizationSlug")}),_=!!D.value,R=async a=>{if((a.preventDefault(),_)&&P)try{let t={name:D.value};e.hideSlug||(t.slug=O.value);let a=await L(t);if(B&&await a.setLogo({file:B}),w.current=a,await T({organization:a}),k.revalidate?.(),y)return void await y.nextTask();if(e.skipInvitationScreen??1===a.maxAllowedMemberships)return K();i.nextStep()}catch(e){(0,z.S3)(e,[D,O],t.setError)}},K=()=>{e.navigateAfterCreateOrganization?.(w.current),e.onComplete?.()},N=e=>{O.setValue(e)},W="organizationList"===e.flow?"subtitle":void 0;return(0,a.BX)(b.en,{...i.props,children:[(0,a.tZ)(d.Y,{headerTitle:e?.startPage?.headerTitle,headerSubtitle:e?.startPage?.headerSubtitle,headerTitleTextVariant:"h2",headerSubtitleTextVariant:W,sx:e=>({minHeight:e.sizes.$60,gap:e.space.$6,textAlign:"left"}),children:(0,a.BX)(s.l.Root,{onSubmit:R,sx:e=>({gap:e.space.$6}),children:[(0,a.tZ)(x.Col,{children:(0,a.tZ)(v.D,{organization:{name:D.value},onAvatarChange:async e=>await I(e),onAvatarRemove:B?()=>(t.setIdle(),I(null)):null,avatarPreviewPlaceholder:(0,a.tZ)(g.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,a.tZ)(x.Icon,{size:"md",icon:S.gq,sx:e=>({color:e.colors.$colorMutedForeground,transitionDuration:e.transitionDuration.$controls})}),sx:e=>({width:e.sizes.$16,height:e.sizes.$16,borderRadius:e.radii.$md,borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$dashed,borderColor:e.colors.$borderAlpha200,backgroundColor:e.colors.$neutralAlpha50,":hover":{backgroundColor:e.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})})}),(0,a.tZ)(s.l.ControlRow,{elementId:D.id,children:(0,a.tZ)(s.l.PlainInput,{...D.props,onChange:e=>{D.setValue(e.target.value),N((0,p.q)(e.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),!e.hideSlug&&(0,a.tZ)(s.l.ControlRow,{elementId:O.id,children:(0,a.tZ)(s.l.PlainInput,{...O.props,onChange:e=>{N(e.target.value)},isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,a.BX)(c.K,{sx:e=>({marginTop:e.space.$none}),children:[(0,a.tZ)(s.l.SubmitButton,{block:!1,isDisabled:!_,localizationKey:(0,$.u1)("createOrganization.formButtonSubmit")}),e.onCancel&&(0,a.tZ)(s.l.ResetButton,{localizationKey:(0,$.u1)("userProfile.formButtonReset"),block:!1,onClick:e.onCancel})]})]})}),(0,a.tZ)(d.Y,{headerTitle:(0,$.u1)("organizationProfile.invitePage.title"),headerTitleTextVariant:"h2",headerSubtitleTextVariant:W,sx:e=>({minHeight:e.sizes.$60,textAlign:"left"}),children:A&&(0,a.tZ)(Z.l,{resetButtonLabel:(0,$.u1)("createOrganization.invitePage.formButtonReset"),onSuccess:i.nextStep,onReset:K})}),(0,a.BX)(x.Col,{children:[(0,a.tZ)(u.h.Root,{children:(0,a.tZ)(u.h.Title,{localizationKey:(0,$.u1)("organizationProfile.invitePage.title"),sx:{textAlign:"left"}})}),(0,a.tZ)(h.I,{contents:(0,a.tZ)(C.a,{}),sx:e=>({minHeight:e.sizes.$60}),onFinish:K})]})]})})},5536:function(e,t,i){i.d(t,{R:()=>N,S:()=>F});var a=i(9109),n=i(3799),r=i(9144),o=i(2305),l=i(2418),s=i(2672),c=i(2654),d=i(1576),u=i(9888),g=i(2464),h=i(4174),p=i(1816),z=i(5973),m=i(8774),b=i(1217);let x=e=>(0,a.tZ)(u.Col,{elementDescriptor:u.descriptors.organizationListPreviewItems,sx:e=>({maxHeight:`calc(8 * ${e.sizes.$12})`,overflowY:"auto",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$borderAlpha100,...b.common.unstyledScrollbar(e)}),children:e.children}),S=e=>({padding:`${e.space.$4} ${e.space.$5}`}),$=e=>({color:e.colors.$colorForeground,":hover":{color:e.colors.$colorForeground}}),Z=e=>(0,a.BX)(u.Flex,{align:"center",gap:2,sx:[e=>({minHeight:"unset",justifyContent:"space-between",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$borderAlpha100}),S],elementDescriptor:u.descriptors.organizationListPreviewItem,children:[(0,a.tZ)(z.Z,{elementId:"organizationList",mainIdentifierSx:$,organization:e.organizationData}),e.children]}),C=(0,r.forwardRef)((e,t)=>(0,a.tZ)(u.Box,{ref:t,sx:e=>({width:"100%",height:e.space.$12,position:"relative"}),children:(0,a.tZ)(u.Box,{sx:{margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,a.tZ)(u.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:u.descriptors.spinner})})})),v=e=>(0,a.tZ)(u.Button,{elementDescriptor:u.descriptors.organizationListPreviewItemActionButton,textVariant:"buttonSmall",variant:"outline",size:"xs",...e}),f=e=>(0,a.tZ)(m.K,{elementDescriptor:u.descriptors.organizationListPreviewButton,sx:[S],icon:h.nR,...e});var y=i(8870),w=i(7484),L=i(2915),P=i(6988),T=i(7703);let k=(0,s.withCardStateProvider)(e=>{let t=(0,s.useCardState)(),{navigateAfterSelectOrganization:i}=(0,d.useOrganizationListContext)(),{isLoaded:o,setActive:l}=(0,n.eW)(),c=(0,r.useContext)(P.H);return o?(0,a.tZ)(f,{onClick:()=>{let a;return a=e.organization,t.runAsync(async()=>{if(await l({organization:a}),c?.nextTask)return c?.nextTask();await i(a)})},children:(0,a.tZ)(z.Z,{elementId:"organizationList",mainIdentifierSx:$,organization:e.organization})}):null}),A=(0,s.withCardStateProvider)(()=>{let e=(0,s.useCardState)(),{hidePersonal:t,navigateAfterSelectPersonal:i}=(0,d.useOrganizationListContext)(),{isLoaded:r,setActive:o}=(0,n.eW)(),{user:l}=(0,n.aF)();if(!l)return null;let{username:c,primaryEmailAddress:u,primaryPhoneNumber:g,...h}=l;return t?null:(0,a.tZ)(f,{onClick:()=>{if(r)return e.runAsync(async()=>{await o({organization:null}),await i(l)})},children:(0,a.tZ)(L.g,{user:h,mainIdentifierSx:$,title:(0,T.u1)("organizationSwitcher.personalWorkspace")})})}),B={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},I=e=>{let t=(0,s.useCardState)();return(0,a.tZ)(v,{isLoading:t.isLoading,onClick:e.onAccept,localizationKey:(0,u.localizationKeys)("organizationList.action__invitationAccept")})},D=(0,s.withCardStateProvider)(e=>{let t=(0,s.useCardState)(),{getOrganization:i}=(0,n.cL)(),[o,l]=(0,r.useState)(null),{userInvitations:c}=(0,n.eW)({userInvitations:B.userInvitations,userMemberships:B.userMemberships});return o?(0,a.tZ)(k,{organization:o}):(0,a.tZ)(Z,{organizationData:e.publicOrganizationData,children:(0,a.tZ)(I,{onAccept:()=>t.runAsync(async()=>[await e.accept(),await i(e.publicOrganizationData.id)]).then(([e,t])=>{c?.setData?.(t=>(0,w.Sz)(e,t,"negative")),l(t)}).catch(e=>(0,y.S3)(e,[],t.setError))})})}),O=e=>{let t=(0,s.useCardState)(),{userSuggestions:i}=(0,n.eW)({userSuggestions:B.userSuggestions});return"accepted"===e.status?(0,a.tZ)(u.Text,{colorScheme:"secondary",localizationKey:(0,u.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,a.tZ)(v,{isLoading:t.isLoading,onClick:()=>t.runAsync(e.accept).then(e=>i?.setData?.(t=>(0,w.Sz)(e,t))).catch(e=>(0,y.S3)(e,[],t.setError)),localizationKey:(0,u.localizationKeys)("organizationList.action__suggestionsAccept")})},_=(0,s.withCardStateProvider)(e=>(0,a.tZ)(Z,{organizationData:e.publicOrganizationData,children:(0,a.tZ)(O,{...e})})),R=()=>{let{userMemberships:e,userInvitations:t,userSuggestions:i}=(0,n.eW)(B),{ref:a}=(0,g.YD)({threshold:0,onChange:a=>{a&&(e.hasNextPage?e.fetchNext?.():t.hasNextPage?t.fetchNext?.():i.fetchNext?.())}});return{userMemberships:e,userInvitations:t,userSuggestions:i,ref:a}},K=({onCreateOrganizationClick:e})=>{let{user:t}=(0,n.aF)();return t?.createOrganizationEnabled?(0,a.tZ)(o.aU,{elementDescriptor:u.descriptors.organizationListCreateOrganizationActionButton,icon:h.mm,label:(0,u.localizationKeys)("organizationList.action__createOrganization"),onClick:e,sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$borderAlpha100,padding:`${e.space.$5} ${e.space.$5}`}),iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6})}):null},N=(0,s.withCardStateProvider)(()=>{let e=(0,s.useCardState)(),{userMemberships:t,userSuggestions:i,userInvitations:n}=R(),r=t?.isLoading||n?.isLoading||i?.isLoading,o=!!(t?.count||n?.count||i?.count),{hidePersonal:c}=(0,d.useOrganizationListContext)();return(0,a.BX)(l.Z.Root,{children:[(0,a.BX)(l.Z.Content,{sx:e=>({padding:`${e.space.$8} ${e.space.$none} ${e.space.$none}`}),children:[(0,a.tZ)(l.Z.Alert,{sx:e=>({margin:`${e.space.$none} ${e.space.$5}`}),children:e.error}),r&&(0,a.tZ)(u.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$60}),children:(0,a.tZ)(u.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:u.descriptors.spinner})}),!r&&(0,a.tZ)(W,{showListInitially:!(c&&!o)})]}),(0,a.tZ)(l.Z.Footer,{})]})}),W=({showListInitially:e})=>{let{navigateAfterCreateOrganization:t,skipInvitationScreen:i,hideSlug:n}=(0,d.useOrganizationListContext)(),[o,l]=(0,r.useState)(!e);return(0,a.BX)(a.HY,{children:[!o&&(0,a.tZ)(F,{onCreateOrganizationClick:()=>l(!0)}),o&&(0,a.tZ)(u.Box,{sx:e=>({padding:`${e.space.$none} ${e.space.$5} ${e.space.$5}`}),children:(0,a.tZ)(p.$,{flow:"organizationList",startPage:{headerTitle:(0,u.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:i,navigateAfterCreateOrganization:e=>t(e).then(()=>l(!1)),onCancel:e&&o?()=>l(!1):void 0,hideSlug:n})})]})},F=e=>{let t=(0,d.useEnvironment)(),{ref:i,userMemberships:n,userSuggestions:r,userInvitations:l}=R(),{hidePersonal:s}=(0,d.useOrganizationListContext)(),g=n?.isLoading||l?.isLoading||r?.isLoading,h=n?.hasNextPage||l?.hasNextPage||r?.hasNextPage,p=l.data?.filter(e=>!!e),z=r.data?.filter(e=>!!e);return(0,a.BX)(a.HY,{children:[(0,a.BX)(c.h.Root,{sx:e=>({padding:`${e.space.$none} ${e.space.$8}`}),children:[(0,a.tZ)(c.h.Title,{localizationKey:(0,u.localizationKeys)(s?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,a.tZ)(c.h.Subtitle,{localizationKey:(0,u.localizationKeys)("organizationList.subtitle",{applicationName:t.displayConfig.applicationName})})]}),(0,a.tZ)(u.Col,{elementDescriptor:u.descriptors.main,children:(0,a.tZ)(x,{children:(0,a.BX)(o.eX,{role:"menu",children:[(0,a.tZ)(A,{}),(n.count||0)>0&&n.data?.map(e=>(0,a.tZ)(k,{...e},e.id)),!n.hasNextPage&&p?.map(e=>(0,a.tZ)(D,{...e},e.id)),!n.hasNextPage&&!l.hasNextPage&&z?.map(e=>(0,a.tZ)(_,{...e},e.id)),(h||g)&&(0,a.tZ)(C,{ref:i}),(0,a.tZ)(K,{onCreateOrganizationClick:()=>{e.onCreateOrganizationClick()}})]})})})]})}}}]);