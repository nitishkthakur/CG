"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["877"],{3983:function(e,t,n){n.r(t),n.d(t,{SessionTask:()=>m});var r=n(9109),i=n(3799),a=n(2810),o=n(9144),s=n(2418),c=n(2672),l=n(1455),u=n(6663),d=n(1576),Z=n(6988),h=n(4676),g=n(9888),p=n(1816),f=n(5536),$=n(7484);let k=(0,c.withCardStateProvider)(()=>{let{userMemberships:e,userInvitations:t,userSuggestions:n}=(0,i.eW)($.AO),a=(0,o.useRef)(),s=e?.isLoading||t?.isLoading||n?.isLoading,c=!!(e?.count||t?.count||n?.count);return s?(0,r.tZ)(v,{children:(0,r.tZ)(C,{})}):c||"organization-selection"===a.current?(0,r.tZ)(S,{currentFlow:a}):(0,r.tZ)(x,{currentFlow:a})}),S=({currentFlow:e})=>{let[t,n]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{e.current="organization-selection"},[e]),(0,r.tZ)(d.OrganizationListContext.Provider,{value:{componentName:"OrganizationList",skipInvitationScreen:!0},children:(0,r.tZ)(v,{children:t?(0,r.tZ)(g.Box,{sx:e=>({padding:`${e.space.$none} ${e.space.$5} ${e.space.$5}`}),children:(0,r.tZ)(p.$,{flow:"default",startPage:{headerTitle:(0,g.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:!0,onCancel:()=>n(!1)})}):(0,r.tZ)(f.S,{onCreateOrganizationClick:()=>n(!0)})})})},x=({currentFlow:e})=>((0,o.useEffect)(()=>{e.current="create-organization"},[e]),(0,r.tZ)(v,{children:(0,r.tZ)(g.Box,{sx:e=>({padding:`${e.space.$none} ${e.space.$5} ${e.space.$5}`}),children:(0,r.tZ)(p.$,{flow:"default",startPage:{headerTitle:(0,g.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:!0})})})),v=({children:e})=>{let t=(0,c.useCardState)(),{currentTaskContainer:n}=(0,Z.G)();return(0,r.BX)(s.Z.Root,{ref:n,children:[(0,r.BX)(s.Z.Content,{sx:e=>({padding:`${e.space.$8} ${e.space.$none} ${e.space.$none}`}),children:[(0,r.tZ)(s.Z.Alert,{sx:e=>({margin:`${e.space.$none} ${e.space.$5}`}),children:t.error}),e]}),(0,r.tZ)(s.Z.Footer,{})]})},C=()=>(0,r.tZ)(g.Flex,{direction:"row",center:!0,sx:e=>({height:"100%",minHeight:e.sizes.$60}),children:(0,r.tZ)(g.Spinner,{size:"xl",colorScheme:"primary",elementDescriptor:g.descriptors.spinner})}),z=()=>{let e=(0,i.cL)(),{navigate:t}=(0,h.useRouter)(),{redirectUrlComplete:n}=(0,Z.G)();return(0,o.useEffect)(()=>{let t=setTimeout(()=>{e.__internal_navigateToTaskIfAvailable({redirectUrlComplete:n})},500);return()=>clearTimeout(t)},[t,e,n]),(0,r.BX)(s.Z.Root,{children:[(0,r.tZ)(s.Z.Content,{children:(0,r.tZ)(l.I,{})}),(0,r.tZ)(s.Z.Footer,{})]})};function T(){return(0,r.BX)(h.Switch,{children:[(0,r.tZ)(h.Route,{path:u.m.org,children:(0,r.tZ)(k,{})}),(0,r.tZ)(h.Route,{index:!0,children:(0,r.tZ)(z,{})})]})}let m=(0,c.withCardStateProvider)(()=>{let e=(0,i.cL)(),{navigate:t}=(0,h.useRouter)(),n=(0,o.useContext)(d.SignInContext),c=(0,o.useContext)(d.SignUpContext),[u,g]=(0,o.useState)(!1),p=(0,o.useRef)(null),f=n?.afterSignInUrl??c?.afterSignUpUrl??e?.buildAfterSignInUrl();(0,o.useEffect)(()=>{if(u)return;let n=e.session?.currentTask;if(!n||e.session?.status==="active")return void t(f);e.telemetry?.record((0,a.Zg)("SessionTask",{task:n.key}))},[e,t,u,f]);let $=(0,o.useCallback)(()=>(g(!0),e.__internal_navigateToTaskIfAvailable({redirectUrlComplete:f}).finally(()=>g(!1))),[e,f]);return e.session?.currentTask?(0,r.tZ)(Z.H.Provider,{value:{nextTask:$,redirectUrlComplete:f,currentTaskContainer:p},children:(0,r.tZ)(T,{})}):(0,r.BX)(s.Z.Root,{sx:()=>({minHeight:p?p.current?.offsetHeight:void 0}),children:[(0,r.tZ)(s.Z.Content,{sx:()=>({flex:1}),children:(0,r.tZ)(l.I,{})}),(0,r.tZ)(s.Z.Footer,{})]})})}}]);